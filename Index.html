<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Água Já – Itupeva – Disk água mineral</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #e0f7fa;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 600px;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1, h2, h3 {
      text-align: center;
      color: #0277bd;
      margin-top: 0;
      margin-bottom: 20px;
    }
    .section {
      margin-bottom: 20px;
      background: #f1f8e9;
      padding: 15px;
      border-radius: 4px;
    }
    label {
      display: block;
      font-weight: bold;
      margin-bottom: 5px;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      background-color: #0277bd;
      color: white;
      border: none;
      padding: 15px;
      font-size: 1.1em;
      border-radius: 4px;
      width: 100%;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #01579b;
    }
    .radio-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 15px;
    }
    .radio-option {
      display: flex;
      align-items: center;
      font-size: 1em;
    }
    .radio-option input[type="radio"] {
      width: 20px;
      height: 20px;
      margin-right: 8px;
    }
    .product-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 10px;
    }
    .product-table th,
    .product-table td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #ccc;
    }
    .order-summary ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .order-summary li {
      margin-bottom: 5px;
    }
    #changeSection {
      display: none;
      margin-top: 10px;
    }
    #changeValueContainer {
      display: none;
      margin-top: 5px;
    }
    .info-text {
      font-size: 0.9em;
      color: #555;
      text-align: center;
      margin-top: 5px;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1>Água Já – Itupeva</h1>
    <h2>Disk água mineral</h2>

    <!-- Seleção de produtos com UM botão final para adicionar -->
    <div class="section">
      <h3>Selecione os Produtos</h3>
      <table class="product-table">
        <thead>
          <tr>
            <th>Produto</th>
            <th>Preço</th>
            <th style="width: 80px;">Qtd</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Água Mineral 500ml</td>
            <td>R$2,50</td>
            <td><input type="number" id="qty1" min="0" max="20" value="0" /></td>
          </tr>
          <tr>
            <td>Água Mineral 1L</td>
            <td>R$4,50</td>
            <td><input type="number" id="qty2" min="0" max="20" value="0" /></td>
          </tr>
          <tr>
            <td>Água Mineral 2L</td>
            <td>R$7,50</td>
            <td><input type="number" id="qty3" min="0" max="20" value="0" /></td>
          </tr>
          <tr>
            <td>Galão de 20L</td>
            <td>R$15,00</td>
            <td><input type="number" id="qty4" min="0" max="20" value="0" /></td>
          </tr>
        </tbody>
      </table>
      <button onclick="addProductsToOrder()">Adicionar ao Pedido</button>

      <hr />
      <h3>Seu Pedido</h3>
      <div class="order-summary">
        <ul id="orderList"></ul>
      </div>
    </div>

    <!-- Entrega ou Retirada -->
    <div class="section">
      <h3>Entrega ou Retirada?</h3>
      <div class="radio-group" id="deliveryGroup">
        <div class="radio-option">
          <input type="radio" name="deliveryMethod" value="Entrega" />
          <label>Entrega (sem desconto)</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="deliveryMethod" value="Retirada" />
          <label>Retirada (15% de desconto)</label>
        </div>
      </div>
    </div>

    <!-- Forma de pagamento -->
    <div class="section">
      <h3>Forma de Pagamento</h3>
      <div class="radio-group" id="paymentGroup">
        <div class="radio-option">
          <input type="radio" name="paymentMethod" value="Cartão de crédito (na hora da entrega)" />
          <label>Cartão de crédito (na hora da entrega)</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="paymentMethod" value="Pix (enviar comprovante por WhatsApp)" />
          <label>Pix (enviar comprovante por WhatsApp)</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="paymentMethod" value="Dinheiro" />
          <label>Dinheiro</label>
        </div>
      </div>
      <!-- Troco (se dinheiro) -->
      <div id="changeSection">
        <label>Precisa de troco?</label>
        <div class="radio-group" style="flex-direction: row; gap:15px;">
          <div class="radio-option">
            <input type="radio" name="changeNeeded" value="Sim" onclick="handleChangeOption()" />
            <label>Sim</label>
          </div>
          <div class="radio-option">
            <input type="radio" name="changeNeeded" value="Não" onclick="handleChangeOption()" />
            <label>Não</label>
          </div>
        </div>
        <div id="changeValueContainer">
          <label for="changeValue">Valor do Troco:</label>
          <input type="number" id="changeValue" min="0" step="1" value="0" />
        </div>
      </div>
    </div>

    <!-- Precisa de comprovante e Observação -->
    <div class="section">
      <h3>Detalhes Extras</h3>
      <label>Precisa de comprovante?</label>
      <div class="radio-group" style="flex-direction: row; gap:15px;">
        <div class="radio-option">
          <input type="radio" name="comprovanteNeeded" value="Sim" />
          <label>Sim</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="comprovanteNeeded" value="Não" />
          <label>Não</label>
        </div>
      </div>
      <label for="obs">Observação (opcional):</label>
      <textarea id="obs" rows="3" placeholder="Algum detalhe extra?"></textarea>
    </div>

    <!-- Dados do Cliente -->
    <div class="section">
      <h3>Seus Dados</h3>
      <div class="form-group">
        <label for="clientName">Nome:</label>
        <input type="text" id="clientName" />
      </div>
      <div class="form-group">
        <label for="clientPhone">Celular:</label>
        <input type="tel" id="clientPhone" />
      </div>
      <div class="form-group">
        <label for="clientAddress">Endereço:</label>
        <textarea id="clientAddress" rows="2"></textarea>
      </div>
    </div>

    <!-- Botão único para confirmar (enviar) -->
    <button id="btnConfirm" onclick="confirmOrder()">
      Confirme seu pedido
    </button>
    <p class="info-text">
      Ao clicar em “Confirme seu pedido”, seu pedido será enviado via WhatsApp. 
      <br />
      Só após essa confirmação seu pedido será efetivado.
    </p>
  </div>

  <script>
    let order = [];

    // Adiciona produtos ao pedido (um único botão ao final da lista)
    function addProductsToOrder() {
      // Lê as quantidades de cada produto
      const qty1 = parseInt(document.getElementById("qty1").value);
      const qty2 = parseInt(document.getElementById("qty2").value);
      const qty3 = parseInt(document.getElementById("qty3").value);
      const qty4 = parseInt(document.getElementById("qty4").value);

      // Reseta o array para evitar duplicar
      order = [];

      if (qty1 > 0) {
        order.push({ product: "Água Mineral 500ml", price: 2.50, quantity: qty1 });
      }
      if (qty2 > 0) {
        order.push({ product: "Água Mineral 1L", price: 4.50, quantity: qty2 });
      }
      if (qty3 > 0) {
        order.push({ product: "Água Mineral 2L", price: 7.50, quantity: qty3 });
      }
      if (qty4 > 0) {
        order.push({ product: "Galão de 20L", price: 15.00, quantity: qty4 });
      }

      updateOrderSummary();
      alert("Produtos adicionados ao pedido!");
    }

    // Atualiza o resumo do pedido
    function updateOrderSummary() {
      const orderList = document.getElementById("orderList");
      orderList.innerHTML = "";
      order.forEach((item) => {
        const li = document.createElement("li");
        const subtotal = (item.price * item.quantity).toFixed(2);
        li.textContent = `${item.quantity} x ${item.product} - R$${subtotal}`;
        orderList.appendChild(li);
      });
    }

    // Exibe/oculta campo de troco se pagamento = dinheiro
    document.getElementById("paymentGroup").addEventListener("change", function() {
      const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked')?.value;
      const changeSection = document.getElementById("changeSection");
      if (paymentMethod === "Dinheiro") {
        changeSection.style.display = "block";
      } else {
        changeSection.style.display = "none";
      }
    });

    // Exibe/oculta valor de troco se “Sim”
    function handleChangeOption() {
      const changeNeeded = document.querySelector('input[name="changeNeeded"]:checked')?.value;
      const container = document.getElementById("changeValueContainer");
      if (changeNeeded === "Sim") {
        container.style.display = "block";
      } else {
        container.style.display = "none";
      }
    }

    // Ao clicar em "Confirme seu pedido"
    function confirmOrder() {
      // 1. Verifica se há produtos no pedido
      if (order.length === 0) {
        alert("Por favor, selecione a quantidade de produtos e clique em 'Adicionar ao Pedido'.");
        return;
      }

      // 2. Verifica entrega ou retirada
      const deliveryMethod = document.querySelector('input[name="deliveryMethod"]:checked')?.value;
      if (!deliveryMethod) {
        alert("Por favor, selecione Entrega ou Retirada.");
        return;
      }

      // 3. Verifica forma de pagamento
      const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked')?.value;
      if (!paymentMethod) {
        alert("Por favor, selecione a forma de pagamento.");
        return;
      }

      // 4. Se pagamento = Dinheiro, verifica troco
      let trocoNeeded = "";
      let trocoValue = "";
      if (paymentMethod === "Dinheiro") {
        const changeNeeded = document.querySelector('input[name="changeNeeded"]:checked')?.value;
        if (!changeNeeded) {
          alert("Por favor, informe se precisa de troco (Sim ou Não).");
          return;
        }
        trocoNeeded = changeNeeded;
        if (trocoNeeded === "Sim") {
          trocoValue = document.getElementById("changeValue").value;
        }
      }

      // 5. Precisa de comprovante?
      const comprovanteOption = document.querySelector('input[name="comprovanteNeeded"]:checked')?.value;
      const comprovanteText = comprovanteOption ? comprovanteOption : "Não especificado";

      // 6. Observação
      const obsText = document.getElementById("obs").value.trim();

      // 7. Dados do cliente
      const clientName = document.getElementById("clientName").value.trim();
      const clientPhone = document.getElementById("clientPhone").value.trim();
      const clientAddress = document.getElementById("clientAddress").value.trim();

      if (!clientName || !clientPhone || !clientAddress) {
        alert("Por favor, preencha Nome, Celular e Endereço.");
        return;
      }

      // 8. Calcula total
      let total = 0;
      order.forEach((item) => {
        total += item.price * item.quantity;
      });

      // 9. Monta mensagem
      let message = `Nome: ${clientName}\n`;
      message += `Celular: ${clientPhone}\n`;
      message += `Endereço: ${clientAddress}\n\n`;
      message += `Entrega/Retirada: ${deliveryMethod}\n`;
      message += `Forma de Pagamento: ${paymentMethod}\n`;
      if (paymentMethod === "Dinheiro") {
        message += `Precisa de troco? ${trocoNeeded}\n`;
        if (trocoNeeded === "Sim") {
          message += `Valor do Troco: R$${trocoValue}\n`;
        }
      }
      message += `Precisa de comprovante? ${comprovanteText}\n\n`;
      message += `Produtos:\n`;
      order.forEach((item) => {
        const subtotal = item.price * item.quantity;
        message += `${item.quantity} x ${item.product} - R$${subtotal.toFixed(2)}\n`;
      });

      // Desconto se retirada
      if (deliveryMethod === "Retirada") {
        const discount = total * 0.15;
        const discountedTotal = total - discount;
        message += `\nTotal sem desconto: R$${total.toFixed(2)}\n`;
        message += `Desconto (15%): -R$${discount.toFixed(2)}\n`;
        message += `Total a Pagar: R$${discountedTotal.toFixed(2)}\n`;
      } else {
        message += `\nTotal a Pagar: R$${total.toFixed(2)}\n`;
      }

      if (obsText) {
        message += `\nObservação: ${obsText}\n`;
      }

      // 10. Abre WhatsApp
      const encodedMsg = encodeURIComponent(message);
      const whatsappNumber = "5511999999999"; // Seu número no formato internacional
      const url = `https://wa.me/${whatsappNumber}?text=${encodedMsg}`;
      window.open(url, "_blank");

      alert("Seu pedido foi enviado via WhatsApp!");
    }
  </script>
</body>
</html>
